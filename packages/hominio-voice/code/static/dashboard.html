<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hominio Dashboard</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu,
          Cantarell, sans-serif;
        background: url("static/background.jpg") no-repeat center center fixed;
        background-size: cover;
        color: #1e3a5f;
        min-height: 100vh;
        max-height: 100vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      .main-container {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: stretch;
        padding: 2rem;
        max-width: 1600px;
        margin: 0 auto;
        width: 100%;
        min-height: 0;
        overflow: hidden;
        position: relative;
        gap: 1.5rem;
      }

      /* Navigation */
      .nav-button {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 12px;
        padding: 12px 20px;
        color: #2c3e50;
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .nav-button:hover {
        background: rgba(255, 255, 255, 1);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }

      /* Sessions Panel */
      .sessions-panel {
        width: 300px;
        background: rgba(255, 255, 255, 0.25);
        backdrop-filter: blur(15px);
        border-radius: 20px;
        padding: 1.5rem;
        box-shadow: 0 15px 35px rgba(30, 58, 95, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.3);
        display: flex;
        flex-direction: column;
        gap: 1rem;
        position: relative;
        overflow: hidden;
        max-height: calc(100vh - 4rem);
        overflow-y: auto;
      }

      .sessions-header {
        font-size: 1rem;
        font-weight: 700;
        color: #2c3e50;
        text-align: center;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .sessions-summary {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 10px;
        padding: 0.75rem;
        border: 1px solid rgba(255, 255, 255, 0.4);
        margin-top: 0.5rem;
      }

      .sessions-summary-title {
        font-size: 0.7rem;
        font-weight: 700;
        color: #2c3e50;
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        text-align: center;
      }

      .summary-stats {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0.5rem;
      }

      .summary-stat {
        text-align: center;
      }

      .summary-stat-value {
        font-size: 1.1rem;
        font-weight: 700;
        color: #2c3e50;
        margin-bottom: 0.2rem;
      }

      .summary-stat-label {
        font-size: 0.6rem;
        color: #7f8c8d;
        text-transform: uppercase;
        letter-spacing: 0.3px;
      }

      .sessions-list {
        flex: 1;
        overflow-y: auto;
      }

      .session-item {
        background: rgba(255, 255, 255, 0.4);
        border-radius: 12px;
        padding: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.4);
        margin-bottom: 0.75rem;
        transition: all 0.3s ease;
      }

      .session-item:last-child {
        margin-bottom: 0;
      }

      .session-item.current {
        border-color: #7ed4ad;
        background: rgba(126, 212, 173, 0.15);
        box-shadow: 0 0 15px rgba(126, 212, 173, 0.2);
      }

      .session-id {
        font-size: 0.75rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 0.5rem;
        font-family: monospace;
      }

      .session-status {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.7rem;
        margin-bottom: 0.3rem;
      }

      .session-status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        flex-shrink: 0;
      }

      .session-status-dot.active {
        background: #27ae60;
        animation: pulse-green 2s infinite;
      }

      .session-status-dot.inactive {
        background: #95a5a6;
      }

      .session-status-dot.speaking {
        background: #f39c12;
        animation: pulse-orange 1s infinite;
      }

      .session-status-dot.listening {
        background: #3498db;
        animation: pulse-blue 1.5s infinite;
      }

      .session-status-dot.processing {
        background: #9b59b6;
        animation: pulse-purple 1.2s infinite;
      }

      @keyframes pulse-green {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.2);
        }
      }

      @keyframes pulse-orange {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.3);
        }
      }

      @keyframes pulse-blue {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.1);
        }
      }

      @keyframes pulse-purple {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.15);
        }
      }

      .session-details {
        font-size: 0.65rem;
        color: #7f8c8d;
        line-height: 1.3;
      }

      .session-detail-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.2rem;
      }

      .session-detail-row:last-child {
        margin-bottom: 0;
      }

      /* Load Test Panel (Center) */
      .load-test-panel {
        flex: 1;
        max-width: 810px;
        width: 100%;
        background: rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(15px);
        border-radius: 24px;
        padding: 2rem;
        box-shadow: 0 20px 40px rgba(30, 58, 95, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.2);
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        max-height: calc(100vh - 4rem);
        overflow-y: auto;
        position: relative;
      }

      .load-test-header {
        text-align: center;
        margin-bottom: 1rem;
      }

      .load-test-title {
        font-size: 2rem;
        font-weight: 700;
        color: #2c3e50;
        margin-bottom: 0.5rem;
      }

      .load-test-subtitle {
        font-size: 1rem;
        color: #7f8c8d;
        font-weight: 400;
      }

      .control-section {
        background: rgba(255, 255, 255, 0.4);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 8px 20px rgba(30, 58, 95, 0.1);
      }

      .section-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .controls-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 1.5rem;
      }

      .control-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .control-label {
        font-size: 0.9rem;
        font-weight: 500;
        color: #2c3e50;
        margin-bottom: 0.3rem;
      }

      .slider-container {
        position: relative;
      }

      .slider {
        width: 100%;
        height: 8px;
        border-radius: 4px;
        background: rgba(255, 255, 255, 0.3);
        outline: none;
        -webkit-appearance: none;
        transition: all 0.3s ease;
      }

      .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #7ed4ad;
        cursor: pointer;
        border: 2px solid #fff;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
      }

      .slider::-webkit-slider-thumb:hover {
        transform: scale(1.1);
        background: #6bc49a;
      }

      .slider-value {
        position: absolute;
        top: -30px;
        left: 50%;
        transform: translateX(-50%);
        background: #2c3e50;
        color: white;
        padding: 0.2rem 0.5rem;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: 500;
        white-space: nowrap;
      }

      .test-button {
        background: #2c3e50;
        color: white;
        border: none;
        border-radius: 25px;
        padding: 1rem 2rem;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: inherit;
        width: 100%;
        margin-top: 1rem;
        appearance: none;
        outline: none;
      }

      .test-button:hover:not(:disabled) {
        background: #34495e;
        transform: translateY(-1px);
        box-shadow: 0 5px 10px rgba(44, 62, 80, 0.2);
      }

      .test-button:active {
        transform: translateY(0);
      }

      .test-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .stop-button {
        background: #e74c3c;
      }

      .stop-button:hover:not(:disabled) {
        background: #c0392b;
      }

      /* User Display */
      .users-container {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 15px;
        padding: 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.4);
        max-height: 400px;
        overflow-y: auto;
      }

      .users-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 1rem;
      }

      .user-item {
        background: rgba(255, 255, 255, 0.4);
        border-radius: 10px;
        padding: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.4);
        transition: all 0.3s ease;
      }

      .user-item.active {
        border-color: #7ed4ad;
        background: rgba(126, 212, 173, 0.15);
        box-shadow: 0 0 15px rgba(126, 212, 173, 0.2);
      }

      .user-header {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.5rem;
      }

      .user-status-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        flex-shrink: 0;
      }

      .user-status-dot.connected {
        background: #27ae60;
        animation: pulse-green 2s infinite;
      }

      .user-status-dot.speaking {
        background: #f39c12;
        animation: pulse-orange 1s infinite;
      }

      .user-status-dot.listening {
        background: #3498db;
        animation: pulse-blue 1.5s infinite;
      }

      .user-status-dot.error {
        background: #e74c3c;
      }

      .user-id {
        font-size: 0.8rem;
        font-weight: 600;
        color: #2c3e50;
        font-family: monospace;
      }

      .user-stats {
        font-size: 0.7rem;
        color: #7f8c8d;
        line-height: 1.4;
      }

      /* System Stats Panel */
      .stats-panel {
        width: 300px;
        background: rgba(255, 255, 255, 0.25);
        backdrop-filter: blur(15px);
        border-radius: 20px;
        padding: 1.5rem;
        box-shadow: 0 15px 35px rgba(30, 58, 95, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.3);
        display: flex;
        flex-direction: column;
        gap: 1rem;
        max-height: calc(100vh - 4rem);
        overflow-y: auto;
      }

      .stats-header {
        font-size: 1rem;
        font-weight: 700;
        color: #2c3e50;
        text-align: center;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .stat-card {
        background: rgba(255, 255, 255, 0.4);
        border-radius: 12px;
        padding: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.4);
        margin-bottom: 0.75rem;
        transition: all 0.3s ease;
      }

      .stat-card:last-child {
        margin-bottom: 0;
      }

      .stat-title {
        font-size: 0.8rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .stat-value {
        font-size: 1.2rem;
        font-weight: 700;
        color: #7ed4ad;
        margin-bottom: 0.3rem;
      }

      .stat-description {
        font-size: 0.7rem;
        color: #7f8c8d;
        line-height: 1.3;
      }

      .progress-bar {
        width: 100%;
        height: 6px;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 3px;
        overflow: hidden;
        margin-top: 0.5rem;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #7ed4ad, #6bc49a);
        border-radius: 3px;
        transition: width 0.3s ease;
      }

      /* Status Messages */
      .status-message {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 10px;
        padding: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.4);
        text-align: center;
        font-weight: 500;
        color: #2c3e50;
      }

      .status-message.success {
        background: rgba(126, 212, 173, 0.2);
        border-color: #7ed4ad;
        color: #27ae60;
      }

      .status-message.error {
        background: rgba(231, 76, 60, 0.2);
        border-color: #e74c3c;
        color: #e74c3c;
      }

      /* Responsive Design */
      @media (max-width: 1200px) {
        .main-container {
          flex-direction: column;
          gap: 1rem;
          padding: 1rem;
        }

        .sessions-panel,
        .stats-panel {
          width: 100%;
          max-height: 200px;
        }

        .load-test-panel {
          max-height: none;
        }
      }

      /* Connection Status */
      .connection-status {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
      }

      .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #e74c3c;
        animation: pulse-dot 2s infinite;
        flex-shrink: 0;
      }

      .status-dot.connected {
        background: #27ae60;
        animation: none;
      }

      @keyframes pulse-dot {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      /* Sessions Panel (Left) */
      .sessions-panel {
        background: white;
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        height: fit-content;
        max-height: calc(100vh - 4rem);
        overflow-y: auto;
      }

      .sessions-header {
        font-size: 1.2rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .sessions-summary {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1.5rem;
      }

      .sessions-summary-title {
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 0.75rem;
        text-align: center;
      }

      .summary-stats {
        display: flex;
        justify-content: space-around;
        gap: 1rem;
      }

      .summary-stat {
        text-align: center;
      }

      .summary-stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: #2c3e50;
        line-height: 1;
      }

      .summary-stat-label {
        font-size: 0.8rem;
        color: #7f8c8d;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-top: 0.25rem;
      }

      .sessions-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .session-item {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 1rem;
        border-left: 4px solid #3498db;
      }

      .session-item.current {
        border-left-color: #27ae60;
        background: #e8f5e8;
      }

      .session-id {
        font-family: monospace;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 0.5rem;
      }

      .session-status {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.75rem;
      }

      .session-status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        flex-shrink: 0;
      }

      .session-status-dot.connected {
        background: #27ae60;
      }

      .session-status-dot.speaking {
        background: #f39c12;
        animation: pulse-orange 1s infinite;
      }

      .session-status-dot.listening {
        background: #3498db;
        animation: pulse-blue 1.5s infinite;
      }

      .session-status-dot.processing {
        background: #9b59b6;
        animation: pulse-purple 1s infinite;
      }

      .session-status-dot.inactive {
        background: #95a5a6;
      }

      .session-details {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
      }

      .session-detail-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.85rem;
      }

      .session-detail-row span:first-child {
        color: #7f8c8d;
        font-weight: 500;
      }

      .session-detail-row span:last-child {
        color: #2c3e50;
        font-weight: 600;
      }

      @keyframes pulse-orange {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.3);
        }
      }

      @keyframes pulse-blue {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.1);
        }
      }

      @keyframes pulse-purple {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.15);
        }
      }

      @media (max-width: 768px) {
        .controls-grid {
          grid-template-columns: 1fr;
        }

        .users-grid {
          grid-template-columns: 1fr;
        }

        .nav-button {
          top: 10px;
          right: 10px;
          padding: 8px 12px;
          font-size: 0.8rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- Navigation Button -->
    <a href="/" class="nav-button">
      <svg
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg">
        <path
          d="M9 19l-7-7 7-7m8 14l-7-7 7-7"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round" />
      </svg>
      Back to Voice Chat
    </a>

    <div class="main-container">
      <!-- Sessions Panel (Left) -->
      <div class="sessions-panel">
        <div class="sessions-header"><span>👥</span> Active Sessions</div>

        <div class="sessions-summary">
          <div class="sessions-summary-title">Overview</div>
          <div class="summary-stats">
            <div class="summary-stat">
              <div class="summary-stat-value" id="totalSessionsCount">0</div>
              <div class="summary-stat-label">Total</div>
            </div>
            <div class="summary-stat">
              <div class="summary-stat-value" id="activeSessionsCount">0</div>
              <div class="summary-stat-label">Active</div>
            </div>
          </div>
        </div>

        <div id="sessionsList" class="sessions-list">
          <!-- Sessions will be populated here -->
        </div>
      </div>

      <!-- Load Test Panel (Center) -->
      <div class="load-test-panel">
        <div class="load-test-header">
          <div class="load-test-title">Load Test Dashboard</div>
          <div class="load-test-subtitle">
            Simulate concurrent voice chat users
          </div>
        </div>

        <!-- Test Configuration -->
        <div class="control-section">
          <div class="section-title">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path
                d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                fill="currentColor" />
            </svg>
            Test Configuration
          </div>

          <div class="controls-grid">
            <div class="control-group">
              <div class="control-label">Concurrent Users</div>
              <div class="slider-container">
                <input
                  type="range"
                  id="userCount"
                  class="slider"
                  min="1"
                  max="30"
                  value="5" />
                <div class="slider-value" id="userCountValue">5 users</div>
              </div>
            </div>

            <div class="control-group">
              <div class="control-label">Test Duration</div>
              <div class="slider-container">
                <input
                  type="range"
                  id="testDuration"
                  class="slider"
                  min="1"
                  max="10"
                  value="3" />
                <div class="slider-value" id="testDurationValue">3 minutes</div>
              </div>
            </div>
          </div>

          <button id="startTest" class="test-button">Start Load Test</button>
          <button
            id="stopTest"
            class="test-button stop-button"
            style="display: none">
            Stop Test
          </button>
          <button
            id="stopTest"
            class="test-button stop-button"
            style="display: none">
            Stop Test
          </button>
        </div>

        <!-- Test Status -->
        <div class="control-section">
          <div class="section-title">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12,6 12,12 16,14"></polyline>
            </svg>
            Test Status
          </div>
          <div id="testStatus" class="status-message">
            Ready to start load test
          </div>
        </div>

        <!-- Active Test Users -->
        <div class="control-section" id="usersSection" style="display: none">
          <div class="section-title">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path
                d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
              <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
            </svg>
            Test Users
          </div>
          <div class="users-container">
            <div id="testUsers" class="users-grid">
              <!-- Test users will be populated here -->
            </div>
          </div>
        </div>
      </div>

      <!-- System Stats Panel (Right) -->
      <div class="stats-panel">
        <div class="stats-header">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path
              d="M9 19c-4.286 1.35-4.286-2.55-6-3m12 5v-3.5c0-1 .099-1.405-.5-2 2.791-.3 5.5-1.366 5.5-6.04a4.567 4.567 0 0 0 -1.333 -3.21 4.192 4.192 0 00-.08-3.227s-1.05-.3-3.476 1.267a12.334 12.334 0 0 0 -6.222 0C6.462 2.723 5.413 3.023 5.413 3.023a4.192 4.192 0 0 0 -.08 3.227A4.566 4.566 0 004 9.486c0 4.64 2.709 5.68 5.5 6.014-.591.589-.56 1.183-.5 2V21"></path>
          </svg>
          System Statistics
        </div>

        <!-- GPU Stats -->
        <div class="stat-card" id="gpuSection">
          <div class="stat-title">GPU Usage</div>
          <div class="stat-value" id="gpuUtilValue">--</div>
          <div class="stat-description">
            Memory: <span id="gpuMemoryValue">-- / --</span><br />
            Temperature: <span id="gpuTempValue">--°C</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="gpuUtilBar" style="width: 0%"></div>
          </div>
        </div>

        <!-- CPU Stats -->
        <div class="stat-card">
          <div class="stat-title">CPU Usage</div>
          <div class="stat-value" id="cpuUsageValue">--</div>
          <div class="stat-description">
            Cores: <span id="cpuCoresInfo">--</span><br />
            Frequency: <span id="cpuFreqValue">--</span><br />
            <span id="cpuTempItem" style="display: none"
              >Temperature: <span id="cpuTempValue">--°C</span></span
            >
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="cpuUsageBar" style="width: 0%"></div>
          </div>
          <div
            id="cpuTempBar"
            class="progress-bar"
            style="display: none; margin-top: 5px">
            <div class="progress-fill" style="width: 0%"></div>
          </div>
        </div>

        <!-- Memory Stats -->
        <div class="stat-card">
          <div class="stat-title">Memory Usage</div>
          <div class="stat-value" id="memoryUsageValue">--</div>
          <div class="stat-description">
            Available: <span id="memoryAvailableValue">--</span>
          </div>
          <div class="progress-bar">
            <div
              class="progress-fill"
              id="memoryUsageBar"
              style="width: 0%"></div>
          </div>
        </div>

        <!-- Connection Status -->
        <div class="stat-card">
          <div class="stat-title">Connection Status</div>
          <div class="stat-value">
            <div class="connection-status">
              <div class="status-dot" id="statusDot"></div>
              <span id="connectionText">Connecting...</span>
            </div>
          </div>
          <div class="stat-description" id="systemInfo">
            Connecting to system...
          </div>
        </div>
      </div>
    </div>

    <script src="/static/stats.js"></script>
    <script src="/static/dashboard-load-test.js"></script>
    <script>
      // Auto-connect to system stats and sessions
      let statsSocket = null;
      let sessionStatsSocket = null;
      let statsManager = null;

      function connectSystemStats() {
        if (statsSocket && statsSocket.readyState === WebSocket.OPEN) return;

        // Initialize stats manager
        if (!statsManager) {
          statsManager = new StatsManager();
        }

        const wsProto = window.location.protocol === "https:" ? "wss:" : "ws:";
        statsSocket = new WebSocket(`${wsProto}//${location.host}/ws`);

        statsSocket.onopen = () => {
          console.log("📊 System stats connected");
          // Request system stats
          statsSocket.send(JSON.stringify({ type: "get_system_stats" }));
        };

        statsSocket.onmessage = (event) => {
          try {
            const data = JSON.parse(event.data);
            // Use stats manager to handle messages
            if (
              statsManager &&
              statsManager.handleStatsMessage(data.type, data.content || data)
            ) {
              // Message handled by stats manager
            } else {
              console.log("Unhandled message:", data);
            }
          } catch (e) {
            console.error("Error parsing stats message:", e);
          }
        };

        statsSocket.onclose = () => {
          console.log("📊 System stats disconnected, reconnecting...");
          setTimeout(connectSystemStats, 2000);
        };

        statsSocket.onerror = (error) => {
          console.error("📊 System stats error:", error);
        };
      }

      // Auto-connect on page load
      connectSystemStats();

      // Request stats periodically
      setInterval(() => {
        if (statsSocket && statsSocket.readyState === WebSocket.OPEN) {
          statsSocket.send(JSON.stringify({ type: "get_system_stats" }));
        }
      }, 2000);
    </script>
  </body>
</html>
